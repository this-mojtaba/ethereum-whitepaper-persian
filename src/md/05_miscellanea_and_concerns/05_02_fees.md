## کارمزدها (Fees)

از آنجا که هر تراکنشی که در بلاکچین منتشر می‌شود، هزینه‌ای را به شبکه تحمیل می‌کند — زیرا همهٔ گره‌ها باید آن را دانلود و اعتبارسنجی کنند — وجود یک سازوکار تنظیم‌کننده برای جلوگیری از سوءاستفاده ضروری است؛ سازوکاری که معمولاً بر پایهٔ کارمزد تراکنش‌ها عمل می‌کند. رویکرد پیش‌فرض در بیت‌کوین، استفاده از کارمزدهای کاملاً داوطلبانه است و این وظیفه را به استخراج‌کنندگان واگذار می‌کند که به‌عنوان دروازه‌بان عمل کرده و حداقل‌های پویا تعیین کنند. این رویکرد در جامعهٔ بیت‌کوین بسیار مورد استقبال قرار گرفته، به‌ویژه به این دلیل که «بازارمحور» (market-based) است و اجازه می‌دهد عرضه و تقاضا میان استخراج‌کنندگان و ارسال‌کنندگان تراکنش، قیمت را تعیین کند.

اما مشکل این استدلال آن است که پردازش تراکنش در واقع یک بازار نیست. هرچند در نگاه اول جذاب به‌نظر می‌رسد که پردازش تراکنش را خدمتی بدانیم که استخراج‌کننده به ارسال‌کننده ارائه می‌دهد، اما در واقعیت، هر تراکنشی که یک استخراج‌کننده در بلاک قرار می‌دهد باید توسط تمام گره‌های شبکه پردازش شود. در نتیجه، بخش عمدهٔ هزینهٔ پردازش تراکنش بر دوش اشخاص ثالث است، نه استخراج‌کننده‌ای که تصمیم به افزودن تراکنش گرفته است. از این‌رو، بروز پدیدهٔ «تراژدی منابع مشترک» (tragedy of the commons) بسیار محتمل خواهد بود.

با این حال، مشخص می‌شود که این نقص در سازوکار بازارمحور، تحت یک مجموعه فرض ساده‌ساز — هرچند نه‌چندان دقیق — به‌طور شگفت‌انگیزی خودبه‌خود خنثی می‌شود. استدلال به این صورت است. فرض کنیم:

- یک تراکنش منجر به اجرای k عملیات شود و پاداشی معادل kR به استخراج‌کننده‌ای که آن را در بلاک قرار دهد بدهد، که در آن R توسط ارسال‌کننده تعیین شده و مقادیر k و R (تقریباً) از پیش برای استخراج‌کننده قابل مشاهده‌اند.
- هر عملیات هزینه‌ای معادل C برای هر گره دارد (یعنی تمام گره‌ها بهره‌وری یکسانی دارند).
- تعداد N گرهٔ استخراج‌کننده وجود دارد که هرکدام دقیقاً سهم برابری از توان پردازشی دارند (یعنی 1/N کل توان).
- هیچ گرهٔ کاملِ غیر استخراج‌کننده‌ای وجود ندارد.

در این حالت، یک استخراج‌کننده زمانی حاضر به پردازش تراکنش است که پاداش مورد انتظار آن از هزینه بیشتر باشد. پاداش مورد انتظار برابر با kR/N است، زیرا استخراج‌کننده تنها با احتمال 1/N بلاک بعدی را استخراج می‌کند، و هزینهٔ پردازش برای استخراج‌کننده برابر با kC است. بنابراین، استخراج‌کنندگان تراکنش‌هایی را می‌پذیرند که kR/N > kC باشد، یا به‌عبارت دیگر R > NC. از آنجا که R کارمزد هر عملیات است، این مقدار حداقلی از سودی را نشان می‌دهد که ارسال‌کننده از تراکنش به‌دست می‌آورد، و NC نیز هزینهٔ کل شبکه برای اجرای یک عملیات است. در نتیجه، استخراج‌کنندگان انگیزه دارند تنها تراکنش‌هایی را بپذیرند که سود کلی آن‌ها بیش از هزینهٔ تحمیلی به شبکه باشد.

اما در عمل، این فرض‌ها به‌طور کامل برقرار نیستند:

- استخراج‌کننده هزینهٔ بیشتری نسبت به سایر گره‌های اعتبارسنج برای پردازش تراکنش می‌پردازد، زیرا زمان اعتبارسنجی اضافه، انتشار بلاک را به تأخیر می‌اندازد و احتمال منقضی‌شدن بلاک را افزایش می‌دهد.
- گره‌های کاملِ غیر استخراج‌کننده واقعاً وجود دارند.
- توزیع توان استخراج در عمل می‌تواند به‌شدت نابرابر باشد.
- افرادی با انگیزه‌های مخرب — مانند سوداگران، دشمنان سیاسی یا افراد نامتعادل — وجود دارند که مطلوبیت آن‌ها در آسیب‌زدن به شبکه تعریف می‌شود و می‌توانند قراردادهایی طراحی کنند که هزینهٔ آن‌ها برای خودشان کم، اما هزینهٔ تحمیلی به سایر گره‌ها بسیار بالا باشد.

عامل اول باعث می‌شود استخراج‌کنندگان تمایل کمتری به افزودن تراکنش‌ها داشته باشند و عامل دوم مقدار NC را افزایش می‌دهد؛ بنابراین این دو اثر تا حدی یکدیگر را خنثی می‌کنند. اما عوامل سوم و چهارم مسئلهٔ اصلی هستند. برای حل آن‌ها، اتریوم یک سقف شناور اعمال می‌کند: هیچ بلاکی نمی‌تواند بیش از BLK_LIMIT_FACTOR برابر میانگین نمایی متحرک بلندمدت عملیات داشته باشد. به‌طور مشخص:

```text
blk.oplimit = floor(
  (blk.parent.oplimit * (EMA_FACTOR - 1) +
   floor(parent.opcount * BLK_LIMIT_FACTOR))
  / EMA_FACTOR
)
```
