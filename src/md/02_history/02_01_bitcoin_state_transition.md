# بیت‌کوین به‌عنوان یک سیستم انتقال وضعیت

(Bitcoin As A State Transition System)

از دیدگاه فنی، دفترکل بیت‌کوین را می‌توان به‌عنوان یک سیستم انتقال وضعیت در نظر گرفت؛ سیستمی که در آن یک «وضعیت» (State) وجود دارد که بیانگر مالکیت تمام بیت‌کوین‌های موجود است، و یک «تابع انتقال وضعیت» (State Transition Function) که با دریافت یک وضعیت و یک تراکنش، وضعیت جدیدی را به‌عنوان خروجی تولید می‌کند.

برای مثال، در یک سیستم بانکی متعارف، وضعیت برابر با ترازنامه است، تراکنش درخواستی برای انتقال مقدار X دلار از A به B محسوب می‌شود، و تابع انتقال وضعیت مقدار X را از حساب A کم کرده و به حساب B اضافه می‌کند. اگر موجودی حساب A از X کمتر باشد، تابع انتقال وضعیت یک خطا بازمی‌گرداند. بنابراین می‌توان این فرآیند را به‌صورت رسمی به شکل زیر تعریف کرد:

APPLY(S, TX) → S' or ERROR

در سیستم بانکی تعریف‌شدهٔ فوق:

APPLY({Alice: $50, Bob: $50},
"send $20 from Alice to Bob")
= {Alice: $30, Bob: $70}

اما در حالت زیر:

APPLY({Alice: $50, Bob: $50},
"send $70 from Alice to Bob")
= ERROR

«وضعیت» در بیت‌کوین مجموعه‌ای از تمام سکه‌هایی است که ایجاد شده‌اند اما هنوز خرج نشده‌اند؛ که از نظر فنی «خروجی‌های خرج‌نشدهٔ تراکنش» (Unspent Transaction Outputs یا UTXO) نامیده می‌شوند. هر UTXO دارای یک مقدار مشخص و یک مالک است که مالکیت آن توسط یک آدرس ۲۰ بایتی تعریف می‌شود؛ آدرسی که در اصل یک کلید عمومی رمزنگاری‌شده است.

یک تراکنش شامل یک یا چند ورودی است که هر ورودی به یک UTXO موجود اشاره می‌کند و دارای یک امضای رمزنگاری‌شده است که با استفاده از کلید خصوصی متناظر با آدرس مالک تولید شده است. همچنین تراکنش می‌تواند شامل یک یا چند خروجی باشد که هر خروجی یک UTXO جدید را ایجاد کرده و به وضعیت شبکه افزوده می‌شود.

Page 5

تابع انتقال وضعیت APPLY(S, TX) → S' را می‌توان به‌طور تقریبی به‌صورت زیر تعریف کرد:

1. برای هر ورودی (Input) در تراکنش TX:
   1. اگر UTXO ارجاع‌داده‌شده در وضعیت S وجود نداشته باشد، یک خطا بازگردانده می‌شود.
   2. اگر امضای ارائه‌شده با مالک UTXO مطابقت نداشته باشد، یک خطا بازگردانده می‌شود.
2. اگر مجموع مقادیر تمام UTXOهای ورودی کمتر از مجموع مقادیر تمام UTXOهای خروجی باشد، یک خطا بازگردانده می‌شود.
3. در غیر این صورت، وضعیت S با حذف تمام UTXOهای ورودی و افزودن تمام UTXOهای خروجی بازگردانده می‌شود.

نیمهٔ نخست گام اول مانع از آن می‌شود که ارسال‌کنندهٔ تراکنش، سکه‌هایی را خرج کند که وجود ندارند؛ نیمهٔ دوم آن مانع خرج‌کردن سکه‌های دیگران می‌شود؛ و گام دوم، اصل بقای ارزش را تضمین می‌کند.

برای استفاده از این سازوکار در پرداخت، پروتکل به این صورت عمل می‌کند: فرض کنید آلیس قصد دارد ۱۱٫۷ بیت‌کوین به باب ارسال کند. ابتدا آلیس مجموعه‌ای از UTXOهای در دسترس خود را که مجموع آن‌ها دست‌کم ۱۱٫۷ بیت‌کوین باشد، انتخاب می‌کند. در عمل، معمولاً امکان دستیابی دقیق به همین مقدار وجود ندارد؛ برای مثال، فرض کنید کوچک‌ترین مجموعه‌ای که آلیس می‌تواند پیدا کند برابر با ۶ + ۴ + ۲ = ۱۲ بیت‌کوین باشد.

در این حالت، آلیس تراکنشی با سه ورودی و دو خروجی ایجاد می‌کند. خروجی نخست شامل ۱۱٫۷ بیت‌کوین با آدرس باب به‌عنوان مالک است، و خروجی دوم شامل ۰٫۳ بیت‌کوین باقی‌مانده به‌عنوان «باقی‌مانده» (Change) است که مالک آن خود آلیس خواهد بود.

Page 6
